<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>我的盆摘</title>
    <link rel="icon" href="/static/imgs/title.png" type="image/x-icon"> 
	<link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">  
	<script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
	<script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body>
    <script type="text/javascript">
        function delete_confirm(url)
        {
        var r=confirm("您确定要删除吗?")
          if(r){window.location.href=url
          }
        }
        function parameter_id(id1,plant_name1,plant_type1,suggest_watering_time1,device_name1,switch_number1) {
        $( '#updateDeptId').val(id1);
        $( '#updateDeptname').val(plant_name1);
        $( '#updateDepttype').val(plant_type1);
        $( '#updateDeptwater').val(suggest_watering_time1);
        $( '#updateDeptdevice').val(device_name1);
        $( '#updateDeptnumber').val(switch_number1);
        }
    </script>
    <div style="margin-top: 20px;" class="container">
        <div  class="row clearfix">
            <div  class="col-md-12 column">
                <ul  class="nav nav-pills">
                    <li class="">
                         <a href="/home">首页</a>
                    </li>
                    <li class="active">
                         <a href="/my_plant">我的盆摘</a>
                    </li>
                    <li class="">
                         <a href="/my_friends">朋友圈</a>
                    </li>
                    <li class="">
                        <a href="/register">用户注册</a>
                    </li>
                    <li class="">
                        <a href="/update_password">修改密码</a>
                    </li>
                    <li class="">
                        <a href="/management/permissionTable">后台管理</a>
                    </li>
                    <li style="float: right;" class="">
                        <div>
                            <a id="modal-207276" href="#modal-container-207276" style="margin-right: 15px;font-size: medium;" data-toggle="modal"" >当前用户: {% if dic1['current_user'] %}{{ dic1['current_user'] }}{% endif %}</a>
                            <a class="btn btn-default" href="/logout">退出</a>
                        </div>
                    </li>
                </ul>
                <div class="page-header">
                    <h1>
                        智能浇水平台<small><span>分享生活,分享快乐!</span></small>
                    </h1>
                </div>
                <!--用户个人信息的模态框-->
                <div class="modal fade" id="modal-container-207276" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
                                <h4 class="modal-title" id="myModalLabel">
                                    用户个人信息
                                </h4>
                            </div>
                            <div class="modal-body">
                                <div class="panel panel-primary">
                                    <div class="panel-heading">
                                        <h3 class="panel-title">
                                            用户名: {{ dic1['current_user'] }}
                                        </h3>
                                    </div>
                                    <div class="panel-body">
                                        姓名: {{ dic1['chinese_name'] }}
                                    </div>
                                    <div class="panel-footer">
                                        性别: {{ dic1['sex'] }}
                                    </div>
                                    <div class="panel-body">
                                        生日: {{ dic1['birthday'] }}
                                    </div>
                                    <div class="panel-footer">
                                        权限: {{ dic1['permission'] }}
                                    </div>
                                    <div class="panel-body">
                                        邮箱: {{ dic1['email'] }}
                                    </div>
                                </div>
                            </div>
                        </div> 
                    </div>
                </div> 
                <div class="carousel slide" id="carousel-88070">
                    <ol class="carousel-indicators">
                        <li data-slide-to="0" data-target="#carousel-88070">
                        </li>
                        <li data-slide-to="1" data-target="#carousel-88070">
                        </li>
                        <li data-slide-to="2" data-target="#carousel-88070" class="active">
                        </li>
                    </ol>
                    <div class="carousel-inner">
                        <div class="item">
                            <img alt="" src="/static/imgs/default.jpg" />
                            <div class="carousel-caption">
                                <p>
                                    这是一款智能浇花神器
                                </p>
                            </div>
                        </div>
                        <div class="item">
                            <img alt="" src="/static/imgs/default2.jpg" />
                            <div class="carousel-caption">
                                <p>
                                    这是一款智能浇花神器
                                </p>
                            </div>
                        </div>
                        <div class="item active">
                            <img alt="" src="/static/imgs/default1.jpg" />
                            <div class="carousel-caption">
                                <p>
                                    这是一款智能浇花神器
                                </p>
                            </div>
                        </div>
                    </div> <a class="left carousel-control" href="#carousel-88070" data-slide="prev"><span class="glyphicon glyphicon-chevron-left"></span></a> <a class="right carousel-control" href="#carousel-88070" data-slide="next"><span class="glyphicon glyphicon-chevron-right"></span></a>
                </div>
                <!--消息提醒-->
                <div style="margin-top: 20px;" class="container">
                    <div class="row clearfix">
                        <div style="padding-left:0" class="col-md-12 column">
                            <div style="margin-right: 15px;" class="{{ dic1['style'] }}">
                                <h4>
                                    {{ dic1['title'] }}
                                </h4> <strong>{{ dic1['title'] }}</strong>{{ dic1['message'] }}
                            </div>
                        </div>
                    </div>
                </div> 
                <div class="panel panel-success">
                    <div class="panel-heading">
                        <h3 class="panel-title">
                            <div>
                                我的盆摘设备<a id="modal-207274" href="#modal-container-207274" style="float: right;font-size: larger;" data-toggle="modal"  > 添加设备</a><a id="modal-207275" href="#modal-container-207275" style="float: right;font-size: larger;margin-right: 8px;" data-toggle="modal"  > 批量导入</a>
                            </div>
                        </h3>
                    </div>
                </div>
                <div class="modal fade" id="modal-container-207274" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
                                <h4 class="modal-title" id="myModalLabel">
                                    添加设备界面
                                </h4>
                            </div>
                            <div class="modal-body">
                                <form role="form" action="/my_plant/AddDevice" method="post" enctype = "multipart/form-data">
                                    {{ form.csrf_token }}
                                    <div class="form-group">
                                        <label for="plant_name">植物名称</label><input type="text" class="form-control" name="plant_name" />
                                    </div>
                                    <div class="form-group">
                                        <label for="plant_type">植物类别</label>
                                        <select name="plant_type" class="form-control">
                                            <option value="None">请选择类别</option>
                                            <option value="1">月季花</option>
                                            <option value="2">玫瑰花</option>
                                            <option value="3">栀子花</option>
                                            <option value="4">太阳花</option>
                                            <option value="5">牡丹花</option>
                                            <option value="6">杜鹃花</option>
                                            <option value="7">其他</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="suggest_watering_time">浇水周期</label><input type="text" class="form-control" name="suggest_watering_time" />
                                    </div>
                                    <div class="form-group">
                                        <label for="device_name">绑定设备</label><input type="text" class="form-control" name="device_name" />
                                    </div>
                                    <div class="form-group">
                                        <label for="switch_number">开关编号</label>
                                        <select name="switch_number" class="form-control">
                                            <option value="None">请选择编号</option>
                                            <option value="1">1号开关</option>
                                            <option value="2">2号开关</option>
                                            <option value="3">3号开关</option>
                                            <option value="4">4号开关</option>
                                            <option value="5">5号开关</option>
                                            <option value="6">6号开关</option>
                                            <option value="7">7号开关</option>
                                            <option value="8">8号开关</option>
                                            <option value="9">9号开关</option>
                                            <option value="10">10号开关</option>
                                            <option value="11">11号开关</option>
                                            <option value="12">12号开关</option>
                                            <option value="13">13号开关</option>
                                            <option value="14">14号开关</option>
                                            <option value="15">15号开关</option>
                                            <option value="16">16号开关</option>
                                        </select>
                                    </div>
                                    <button type="submit" class="btn btn-default btn-primary">提交</button>
                                </form>
                            </div>
                        </div> 
                    </div>
                </div> 
                <!--批量导入设备的模态框-->
                <div class="modal fade" id="modal-container-207275" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
                                <h4 class="modal-title" id="myModalLabel">
                                    批量导入设备
                                </h4>
                            </div>
                            <div class="modal-body">
                                <form role="form" action="/my_plant/ImportDevices" method="post" enctype = "multipart/form-data">
                                    {{ form.csrf_token }}
                                    <div style="margin-top: 15px;" class="form-group">
                                            <label for="file">请上传EXCEL文件</label><input type="file" name="file" />
                                        <p style="margin-top: 10px;" class="help-block">
                                            模板下载链接如下:
                                            <a href="/my_plant/ImportDevices/DownloadTemplateFile">点击下载</a>
                                        </p>
                                    </div>
                                    <button type="submit" class="btn btn-default btn-primary">导入</button>
                                </form>
                            </div>
                        </div> 
                    </div>
                </div>
                <nav  class="navbar navbar-default" role="navigation">
					<div class="navbar-header">
						 <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1"> <span class="sr-only"></span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button> <a class="navbar-brand" href="#">我的盆摘</a>
					</div>
					<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
						<ul class="nav navbar-nav">
							<li class="dropdown">
								 <a href="#" class="dropdown-toggle" data-toggle="dropdown" style="font-size: larger;">植物类别<strong class="caret"></strong></a>
								<ul class="dropdown-menu">
									<li>
										 <a href="/my_plant/search/type?plant_type=1&number=1">月季</a>    
									</li>
									<li class="divider">
									</li>
									<li>
										 <a href="/my_plant/search/type?plant_type=2&number=1">玫瑰</a>
									</li>
									<li class="divider">
									</li>
									<li>
										 <a href="/my_plant/search/type?plant_type=3&number=1">栀子</a>
									</li>
									<li class="divider">
									</li>
									<li>
										 <a href="/my_plant/search/type?plant_type=4&number=1">太阳花</a>
									</li>
									<li class="divider">
									</li>
									<li>
										 <a href="/my_plant/search/type?plant_type=5&number=1">牡丹花</a>
									</li>
									<li class="divider">
									</li>
									<li>
										<a href="/my_plant/search/type?plant_type=6&number=1">杜鹃花</a>
								   	</li>
									<li class="divider">
									</li>
									<li>
										<a href="/my_plant/search/type?plant_type=7&number=1">其他</a>
								   	</li>
								</ul>
							</li>
						</ul>
						<form class="navbar-form navbar-left" role="search" action="/my_plant/search/page" method="post" >
							{{ form.csrf_token }}
							<div class="form-group">
								<input type="text" class="form-control" name = "plant_name" />
							</div> <button type="submit" class="btn btn-default">查询</button><a style="margin-left: 20px;" type="submit" class="btn btn-default" href="/my_plant" >重置</a>
							<div class="contain">
								<p style="color:red">{%if dic1.errors %}{{ dic1.errors }} {% endif %}</p>
							 </div>
						</form>
					</div>
					
				</nav>
                <table class="table table-bordered">
                    <thead>
                        <tr>
                            <th>
                                设备ID
                            </th>
                            <th>
                                用户名
                            </th>
                            <th>
                                植物名称
                            </th>
                            <th>
                                植物类别
                            </th>
                            <th>
                                在线状态
                            </th>
                            <th>
                                上次浇水时间
                            </th>
                            <th>
                                建议浇水周期
                            </th>
                            <th>
                                绑定设备
                            </th>
                            <th>
                                开关编号
                            </th>
                            <th>
                                添加时间
                            </th>
                            <th>
                                操作
                            </th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in list1 %}
                            <tr class="{{ item['style'] }}">
                                <td>
                                    {{ item['id'] }}
                                </td>
                                <td>
                                    {{ item['user_name'] }}
                                </td>
                                <td>
                                    {{ item['plant_name'] }}
                                </td>
                                <td>
                                    {{ item['plant_type'] }} 
                                </td>
                                <td>
                                    {{ item['status'] }}
                                </td>
                                <td>
                                    {{ item['last_watering_time'] }}
                                </td>
                                <td>
                                    {{ item['suggest_watering_time'] }}
                                </td>
                                <td>
                                    {{ item['device_name'] }}
                                </td>
                                <td>
                                    {{ item['switch_number'] }}
                                </td>
                                <th>
                                    {{ item['add_time'] }}
                                </th>
                                <td>
                                    {% set id1=item['id'] %}
                                    {% set name1=item['plant_name'] %}
                                    {% set water1=item['suggest_watering_time'] %}
                                    {% set device1=item['device_name'] %}
                                    {% set switch1=item['switch_number'] %}
                                    {% set type1=item['plant_type'] %}
                                    {% set id1=item['id'] %}
                                    {% set name1=item['plant_name'] %}
                                    {% set water1=item['suggest_watering_time'] %}
                                    {% set device1=item['device_name'] %}
                                    {% set switch1=item['switch_number'] %}
                                    {% set type1=item['plant_type'] %}
                                    <!--根据渲染的花名计判断value写入模态框。-->
                                    {% if type1=='请选择类别' %}{% set type2='None' %}{% endif %}
                                    {% if type1=='月季花' %}{% set type2='1' %}{% endif %}
                                    {% if type1=='玫瑰花' %}{% set type2='2' %}{% endif %}
                                    {% if type1=='栀子花' %}{% set type2='3' %}{% endif %}
                                    {% if type1=='太阳花' %}{% set type2='4' %}{% endif %}
                                    {% if type1=='牡丹花' %}{% set type2='5' %}{% endif %}
                                    {% if type1=='杜鹃花' %}{% set type2='6' %}{% endif %}
                                    {% if type1=='其他' %}{% set type2='7' %}{% endif %}
                                    <a role="button" class="btn btn-primary" href="#" > 浇水</a><a role="button" style="margin-left: 10px;" class="btn btn-default" href="" > 提醒</a><a role="button" onclick="parameter_id('{{ id1 }}','{{ name1 }}','{{ type2 }}','{{ water1 }}','{{ device1 }}','{{ switch1 }}')" id="modal-207277" href="#modal-container-207277" style="margin-left: 10px;" class="btn btn-default"  data-toggle="modal" > 修改</a><button style="margin-left: 10px;" class="btn btn-default btn-primary" onclick="delete_confirm('/my_plant/DeleteDevice?id={{ item.id }}')" > 删除</button>
                                </td>      
                            </tr>  
                        {% endfor %}
                    </tbody>
                </table>
                <!--修改设备信息模态框。-->
                <div class="modal fade" id="modal-container-207277" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                    <div class="modal-dialog">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">x</button>
                                <h4 class="modal-title" id="myModalLabel">
                                    修改设备信息界面
                                </h4>
                            </div>
                            <div class="modal-body">
                                <form role="form" action="/my_plant/UpdateDevices" method="post" enctype = "multipart/form-data">
                                    {{ form.csrf_token }}
                                    <div class="form-group">
                                        <label for="id1">ID</label><input type="text" class="form-control" name="id1" id="updateDeptId"  readonly="readonly" />
                                    </div>
                                    <div class="form-group">
                                        <label for="plant_name1">植物名称</label><input type="text" class="form-control" id="updateDeptname" name="plant_name1" />
                                    </div>
                                    <div class="form-group">
                                        <label for="plant_type1">植物类别</label>
                                        <select id="updateDepttype" name="plant_type1" class="form-control">
                                            <option value="None">请选择类别</option>
                                            <option value="1">月季花</option>
                                            <option value="2">玫瑰花</option>
                                            <option value="3">栀子花</option>
                                            <option value="4">太阳花</option>
                                            <option value="5">牡丹花</option>
                                            <option value="6">杜鹃花</option>
                                            <option value="7">其他</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="suggest_watering_time1">浇水周期</label><input type="text" class="form-control" id="updateDeptwater" name="suggest_watering_time1" />
                                    </div>
                                    <div class="form-group">
                                        <label for="device_name1">绑定设备</label><input type="text" class="form-control" id="updateDeptdevice" name="device_name1" />
                                    </div>
                                    <div class="form-group">
                                        <label for="switch_number1">开关编号</label>
                                        <select id="updateDeptnumber" name="switch_number1" class="form-control">
                                            <option value="None">请选择编号</option>
                                            <option value="1">1号开关</option>
                                            <option value="2">2号开关</option>
                                            <option value="3">3号开关</option>
                                            <option value="4">4号开关</option>
                                            <option value="5">5号开关</option>
                                            <option value="6">6号开关</option>
                                            <option value="7">7号开关</option>
                                            <option value="8">8号开关</option>
                                            <option value="9">9号开关</option>
                                            <option value="10">10号开关</option>
                                            <option value="11">11号开关</option>
                                            <option value="12">12号开关</option>
                                            <option value="13">13号开关</option>
                                            <option value="14">14号开关</option>
                                            <option value="15">15号开关</option>
                                            <option value="16">16号开关</option>
                                        </select>
                                    </div>
                                    <button type="submit" class="btn btn-default btn-primary">提交</button>
                                </form>
                            </div>
                        </div> 
                    </div>
                </div> 
                <div class="row clearfix">
                    <div class="col-md-2 column">
                    </div>
                    <div class="col-md-6 column">
                    </div>
                    <div class="col-md-4 column">
                        <ul style="float: right;" class="pagination">
                            <li class="{{ dic1['active_Prev'] }}">
                                {% if dic1['current_page_number'] <=2  %}
                                    <a href="/my_plant/search/page?number=1">Prev</a>
                                {% else %}
                                    <a href="/my_plant/search/page?number={{ dic1['current_page_number']-1 }}">Prev</a>
                                {% endif %}
                               </li>
                            <li class="{{ dic1['active1'] }}">
                                 <a href="/my_plant/search/page?number=1">1</a>
                            </li>
                            <li class="{{ dic1['active2'] }}">
                                 <a href="/my_plant/search/page?number=2">2</a>
                            </li>
                            <li class="{{ dic1['active3'] }}">
                                 <a href="/my_plant/search/page?number=3">3</a>
                            </li>
                            <li class="{{ dic1['active4'] }}">
                                 <a href="/my_plant/search/page?number=4">4</a>
                            </li>
                            <li class="{{ dic1['active5'] }}">
                                 <a href="/my_plant/search/page?number=5">5</a>
                            </li>
                            <li class="{{ dic1['active_next'] }}">
                                 <a href="/my_plant/search/page?number={{ dic1['current_page_number']+1 }}">Next</a>
                            </li>
                        </ul>
                    </div>
                </div>
                <div style="margin-top: 10px;" class="panel panel-success">
                    <div class="panel-heading">
                        <h3 class="panel-title">
                            联系方式
                        </h3>
                    </div>
                </div>
                <div class="row clearfix">
                    <div class="col-md-12 column">
                        <p>
                            <div>
                                Github项目地址:<a href="https://github.com/xiaowang012/GardenPlatform.git">点击进入</a>
                                邮箱: 1300202481@qq.com
                            </div>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</body>
</html>

